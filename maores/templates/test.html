{% extends "base.html" %}

{% load staticfiles %}

{% block title %}
{{ competition }} ({{ test.division }})
{% endblock %}

{% block navcompetitions %}class="active"{% endblock %}

{% block content %}

<h1> <a href="{{ competition.get_absolute_url }}">{{ competition }}</a>: {{ test.division }}  </h1>

<div class="well">

<h2>Results</h2>

<div class="form-group label-floating">
  <label class="control-label" for="searchtable">Search by name or school.</label>
  <input class="form-control" id="searchtable" type="text">
</div>

<table class="table table-striped table-hover ">
    <thead>
    <tr>
        <th> Rank </th>
        <th> School </th>
        <th> Name </th>
        <th> Score </th>
        <th class='un'> Right </th>
        <th class='un'> Wrong </th>
        <th class='un'> Blank </th>
        <th class='un'> T-Score </th>
        {% if request.user.is_authenticated and "@ahschool.com" in request.user.email %}
        <th class='un'> S-Score </th>
        {% endif %}
    </tr>
    </thead>
    <tbody>
    {% for paper in testpapers %}
    <tr>
        <td> <a href="" data-toggle="modal" data-target="#modal{{ paper.mathlete.mao_id }}">{{ paper.place }}</a> <a name="{{ paper.mathlete.mao_id }}"></a></td>
        <td> {{ paper.school }} </td>
        <td> <a href="{{ paper.mathlete.get_absolute_url }}">{{ paper.mathlete.first_name }} {{ paper.mathlete.last_name }}</a> </td>
        <td> {{ paper.score }} </td>
        <td class='un'> {{ paper.right }} </td>
        <td class='un'> {{ paper.wrong }} </td>
        <td class='un'> {{ paper.blank }} </td>
        <td class='un'> {{ paper.t_score|floatformat:3 }} </td>
        {% if request.user.is_authenticated and "@ahschool.com" in request.user.email %}
        <td class='un'> {{ paper.s_score|floatformat:3 }} </td>
        {% endif %}
    </tr>
    {% endfor %}
    </tbody>
</table>
</div>

{% for paper in testpapers %}
<div id="modal{{ paper.mathlete.mao_id }}" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">{{ paper.mathlete.first_name }} {{ paper.mathlete.last_name }}</h4>
      </div>
      <div class="modal-body">
        <p><table class="table table-striped table-hover ">
            <thead>
              <tr>
                <th>Attribute</th>
                <th>Value</th>
              </tr>
              </thead>
            <tbody>
              <tr>
                <td>Rank</td>
                <td>{{ paper.place }}</td>
              </tr>
              <tr>
                <td>School</td>
                <td>{{ paper.school }}</td>
              </tr>
              <tr>
                <td>Score</td>
                <td>{{ paper.score }}</td>
              </tr>
              <tr>
                <td>Right</td>
                <td>{{ paper.right }}</td>
              </tr>
              <tr>
                <td>Wrong</td>
                <td>{{ paper.wrong }}</td>
              </tr>
              <tr>
                <td>Blank</td>
                <td>{{ paper.blank }}</td>
              </tr>
              <tr>
                <td>T-Score</td>
                <td>{{ paper.t_score|floatformat:3 }}</td>
              </tr>
              {% if request.user.is_authenticated and "@ahschool.com" in request.user.email %}<tr>
                <td>S-Score</td>
                <td>{{ paper.s_score|floatformat:3 }}</td>
              </tr>{% endif %}
            </tbody>
            </table>
            </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>
{% endfor %}

<script>
$(document).ready(function(){
    $('table').filterTable({
        inputSelector : '#searchtable',
        callback: function(term, table) {
            table.find('tr').removeClass('striped').filter(':visible:even').addClass('striped');
        }
    });
});
</script>
{% endblock %}
